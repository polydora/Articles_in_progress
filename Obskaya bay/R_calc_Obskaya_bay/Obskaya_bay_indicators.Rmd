---
title: "Нарушенные сообщества и виды-индикаторы нарушений"
author: ""
date: ""
output: html_document
---






```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)


```


<style type="text/css">

body{ /* Normal  */
      font-size: 18px;
  }
td {  /* Table  */
  font-size: 14px;
}
h1.title {
  font-size: 38px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 28px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>




```{r}
# Packages ######################
library(ggmap)
library(mapproj)
library(maps)

library(rgeos) 

library(mapdata)
library(maptools) # Rgshhs
library(PBSmapping)

library(readxl)
library(dplyr)
library(cowplot)
library(mgcv)
library(reshape2)
library(ggplot2)
library(ggrepel)

library(png)

library(vegan)

library(broom)
library( broom.mixed)


library(ggvegan)
library(car)


theme_set(theme_bw())
```



```{r}

# Функция, задающая нумерацию рисунков

figRef <- local({
    tag <- numeric()
    created <- logical()
    used <- logical()
    function(label, caption, prefix = options("figcap.prefix"), 
        sep = options("figcap.sep"), prefix.highlight = options("figcap.prefix.highlight")) {
        i <- which(names(tag) == label)
        if (length(i) == 0) {
            i <- length(tag) + 1
            tag <<- c(tag, i)
            names(tag)[length(tag)] <<- label
            used <<- c(used, FALSE)
            names(used)[length(used)] <<- label
            created <<- c(created, FALSE)
            names(created)[length(created)] <<- label
        }
        if (!missing(caption)) {
            created[label] <<- TRUE
            paste0(prefix.highlight, prefix, " ", i, sep, prefix.highlight, 
                " ", caption)
        } else {
            used[label] <<- TRUE
            paste(prefix, tag[label])
        }
    }
})

options(figcap.prefix = "Рисунок", figcap.sep = ".", figcap.prefix.highlight = "**")


```



```{r}

# Data reading ####################

Ob_df <- read.csv("Data/Obskaya_bay_map.csv") # Map poligones

# All Station position
stations <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Station parameters", na = "NA")

# Stations with biological samples
stat_full <- stations %>% filter(Exclude == 0)

stat_full <- as.data.frame(stat_full)

# Data on organic matter from the file "Содержание органического вещества в ДО.docx"

org <-  read.csv("Data/Organic matter_2020.csv")

org <- org[org$Station %in% stat_full$Station, ]

org <- org %>% select(Station, Org_Aug_20)



# Data on Granulmetric from the file "Грансостав ДО.docx"

granul <- read_excel("Data/Granulometry_2020.xlsx",  na = "NA")


granul$Small <- with(granul, F_0.002 + `F_0.01-0.002` + `F_0.05-0.01`)              

granul$Big <- rowSums(granul[ ,8:15]  )


granul$Season <- factor(granul$Season)


# Chlorophyll a 

chlor <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Chlorophyll august 2020", na = "NA")


# Biogenes

biogen <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Biogenes_August", na = "NA")

biogen_full <- biogen %>% filter(Exclude == 0) %>% select(-Exclude)

biogen_full_melt <- melt(biogen_full, id.vars = c("Station", "Layer"))

biogen_full_2 <- dcast(biogen_full_melt, Station ~ Layer + variable )



# Zooplancton

zoopl_long <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Zooplancton_long", na = "NA")

zoopl <- dcast(zoopl_long %>%select(-B), Station ~ Taxa) 

zoopl[is.na(zoopl)] <- 0

zoopl$Station_ID <- as.numeric(gsub("O","", zoopl$Station))

zoopl <- zoopl[order(zoopl$Station_ID), ] %>% select(-Station_ID)


# Ship activity and Sattelite data on suspended matter and distances to dumping

# ships <- read.table("Data/Stations_tsm_ships.shp.txt", header = T, sep = "\t")
# write.table(ships, "clipboard", sep = "\t")

ships <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Ship_activity")

ships <- ships %>% filter(Exclude != 1) %>% select(Station, Ships, Distance_Dump, Distance_to_Drag)

ships2 <- merge(stat_full %>% select(Station, Lat, Long), ships)

ships2$Station_ID <- as.numeric(gsub("O","", ships2$Station))

ships2 <- ships2[order(ships2$Station_ID), ] %>% select(-Station_ID)


# nrow(ships2)


# All chlorophyll
chlorophyll <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Chlorophyll august 2020")

# Suspensed matter

suspensed_metter_by_layers <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Suspensed matters August", na = "NA")

suspensed_metter_by_layers <- suspensed_metter_by_layers %>% filter(Exclude !=1) %>% select(-Exclude)  



# Phytoplancton Species

phytopl_long <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Phytoplancton Species long")



# Zoobenthos

bent <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Benthos")


bent_B <- bent %>% filter(Type == "Biomass") %>% select(-Type)

bent_N <- bent %>% filter(Type == "Abundance") %>% select(-Type)


```


```{r}

# Данные для карт ###############################################

# Coordinate limites 
# Ob_x <- c(71, 79)

Ob_x <- c(71, 75)
Ob_y <- c(70, 73.2)

# Sabetta
Sabetta_y <- 71.235220
Sabetta_x <- 72.126754

# Terminal

Terminal_y <- 71.010886
Terminal_x <- 73.793525


grid_data <- expand.grid(Lat = seq(from = 70.01, to =72.89, length.out = 100), Long =  seq(from = 71, to =75.2 , length.out = 100))





Pl_Obskaya_bay <- 
ggplot(Ob_df, aes(x=long, y=lat, group=group)) +
  geom_polygon(fill = "gray90", colour = "gray20") + 
  coord_map(xlim = Ob_x, ylim = Ob_y) + 
  theme_bw() +  
  theme(axis.title.x = element_blank(),  axis.title.y = element_blank(), plot.background = element_blank(), panel.border = element_blank(), panel.grid = element_blank()) + 
  theme(axis.text.x =element_blank(), axis.text.y= element_blank()) + 
  theme(axis.ticks = element_blank())  + 
  geom_point(aes(x = Terminal_x, y = Terminal_y), size = 3, shape = 22, fill = "yellow") 



Obskaya_bay_cover <-function(plt){
  plt <- plt + 
    geom_polygon(data = Ob_df, aes(x=long, y=lat, group=group), fill = "gray90", colour = "gray20") + 
    coord_map(xlim = Ob_x, ylim = Ob_y) + 
    theme_bw() +  
    theme(axis.title.x = element_blank(),  axis.title.y = element_blank(), plot.background = element_blank(), panel.border = element_blank(), panel.grid = element_blank()) + 
    theme(axis.text.x =element_blank(), axis.text.y= element_blank()) + 
    theme(axis.ticks = element_blank()) + 
    geom_point(aes(x = Terminal_x, y = Terminal_y), size = 3, shape = 22, fill = "yellow") +
    geom_point(data = stat_full, aes(x = Long, y = Lat, group = 1), size = 0.5) +
    theme(strip.background = element_blank())
  plt
}





```







```{r}
# Подготовка таблицы предикторов ####################################
predictors <- stat_full %>% select(Station, Lat, Long,  Depth_aug_20, Transparency_aug_20, Surface_Salinity_Aug_20, Bottom_Salinity_Aug_20, Surface_Turbidity_Aug_20, Bottom_Turbidity_Aug_20, Surface_Susp_Aug_20, Interm_Susp_Aug_20, Bottom_Susp_Aug_20)


chlor_surface <- chlor %>% filter(Layer == "Surface") %>% select(Station, Chla) %>% rename(Chla_surface = Chla)


chlor_intermed <- chlor %>% filter(Layer == "Intermediate") %>% select(Station, Chla) %>% rename(Chla_intermed = Chla)

chlor_bottom <- chlor %>% filter(Layer == "Bottom") %>% select(Station, Chla) %>% rename(Chla_bottom = Chla)



predictors2 <- merge(predictors, chlor_surface, all.x = T)

predictors3 <- merge(predictors2, chlor_intermed, all.x = T)

predictors4 <- merge(predictors3, chlor_bottom, all.x = T)


predictors5 <- merge(predictors4, org %>% select(Station, Org_Aug_20), all.x = T)


predictors6 <- merge(predictors5, granul %>% filter(Season == "August") %>% select(Station, Small, Big) %>% rename(Fine_particles = Small, Coarce_particles = Big), all.x =T)


predictors7 <- merge(predictors6, biogen_full_2, all.x = T)


# # All variables from intermediate layer will be excluded from analysis 
# 
# predictors8 <- predictors7 %>% select(-c(Interm_Susp_Aug_20, Chla_intermed, Intermediate_Color, Intermediate_O2, Intermediate_pH,  Intermediate_Amon_N, Intermediate_Nitrit_N, Intermediate_Nitrat_N, Intermediate_Total_N, Intermediate_Mineral_P, Intermediate_Toal_P, Intermediate_Si, Intermediate_Organic_N, Intermediate_Organic_P))

predictors8 <- merge(predictors7, ships2 %>% select(Station, Ships, Distance_Dump, Distance_to_Drag, ))

# nrow(ships2)
# Variable names cleaning

var_names <- names(predictors8)

var_names <- gsub("Bottom", "Bot", var_names)

var_names <- gsub("Surface", "Surf", var_names)

var_names <- gsub("Intermediate", "Int", var_names)

var_names <- gsub("_aug_20", "", var_names)

var_names <- gsub("_Aug_20", "", var_names)


names(predictors8) <- var_names

complete_stations <- nrow(predictors8[complete.cases(predictors8),])

NA_present <- predictors8 %>% summarise_all(funs(sum(is.na(.)))) %>% t() %>% as.data.frame()%>% mutate(Param = row.names(.))

library(imputeTS)
predictors9 <- na_mean(predictors8)

predictors9$Station_ID <- as.numeric(gsub("O","", predictors9$Station))

predictors10 <- predictors9[order(predictors9$Station_ID), ] %>% select(-Station_ID)

# nrow(predictors10)
```




```{r}
# Рабочая таблица по зоопланктону


biogen_full_wide <- dcast(biogen_full_melt, Station  ~ variable, mean)


zoopl_biogen <- merge(zoopl, biogen_full_wide, all.x = T)



suspensed_metter <- suspensed_metter_by_layers %>% group_by(Station) %>% summarise(Suspended_matter = mean(Suspended_matter , na.rm = T)) 

zoopl_biogen_susp <- merge(zoopl_biogen, suspensed_metter, all.x = T)


zoopl_biogen_susp_ship <- merge(zoopl_biogen_susp, ships, all.x = T)

zoopl_pred <- predictors10 %>% select(Station, Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity)

zoopl_biogen_susp_ship_pred <- merge(zoopl_biogen_susp_ship, zoopl_pred, all.x = T)


zoopl_bio <- zoopl_biogen_susp_ship_pred %>% select(-c(Color, O2,pH, Amon_N, Nitrit_N, Nitrat_N, Total_N, Mineral_P, Total_P, Si, Organic_N, Organic_P, Suspended_matter, Ships, Distance_Dump, Distance_to_Drag, Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity))


zoopl_env <- zoopl_biogen_susp_ship_pred %>% select(c(Station,  Color, O2,pH, Amon_N, Nitrit_N, Nitrat_N, Total_N, Mineral_P, Total_P, Si, Organic_N, Organic_P,  Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity))

zoopl_techno <- zoopl_biogen_susp_ship_pred %>% select(Suspended_matter, Ships, Distance_Dump, Distance_to_Drag)

zoopl_coord <- merge(zoopl_env, stat_full %>% select(Station, Long, Lat), all.x = T) %>% select(Station, Long, Lat)



###################################################
# Рабочая таблица по фитопланктону
phytopl_long2 <- phytopl_long %>% select(-Taxa_2) %>% group_by(Station, Taxa_1) %>% summarize(N = mean(N, na.rm = T))


phytopl_wide <- dcast(phytopl_long2, Station  ~ Taxa_1, sum) 



biogen_full_wide <- dcast(biogen_full_melt, Station  ~ variable, mean)


phyt_biogen <- merge(phytopl_wide, biogen_full_wide, all.x = T)

# nrow(phyt_biogen)

suspensed_metter <- suspensed_metter_by_layers %>% group_by(Station) %>% summarise(Suspended_matter = mean(Suspended_matter , na.rm = T)) 

phyt_biogen_susp <- merge(phyt_biogen, suspensed_metter, all.x = T)


phyt_biogen_susp_ship <- merge(phyt_biogen_susp, ships, all.x = T)

phytopl_pred <- predictors10 %>% select(Station, Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity)

phyt_biogen_susp_ship_pred <- merge(phyt_biogen_susp_ship, phytopl_pred, all.x = T)



phytopl_bio <- phyt_biogen_susp_ship_pred %>% select(-c(Color, O2,pH, Amon_N, Nitrit_N, Nitrat_N, Total_N, Mineral_P, Total_P, Si, Organic_N, Organic_P, Suspended_matter, Ships, Distance_Dump, Distance_to_Drag, Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity))


phytopl_env <- phyt_biogen_susp_ship_pred %>% select(c(Station,  Color, O2,pH, Amon_N, Nitrit_N, Nitrat_N, Total_N, Mineral_P, Total_P, Si, Organic_N, Organic_P,  Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity))

phytopl_techno <- phyt_biogen_susp_ship_pred %>% select(Suspended_matter, Ships, Distance_Dump, Distance_to_Drag)

phytopl_coord <- merge(phytopl_env, stat_full %>% select(Station, Long, Lat), all.x = T) %>% select(Station, Long, Lat)


###################################################
# Рабочая таблица по Бентосу



bent_biogen <- merge(bent_N, biogen_full_wide, all.x = T)

# nrow(phyt_biogen)

suspensed_metter <- suspensed_metter_by_layers %>% group_by(Station) %>% summarise(Suspended_matter = mean(Suspended_matter , na.rm = T)) 

bent_biogen_susp <- merge(bent_biogen, suspensed_metter, all.x = T)


bent_biogen_susp_ship <- merge(bent_biogen_susp, ships, all.x = T)

bent_pred <- predictors10 %>% select(Station, Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity, Fine_particles, Coarce_particles)

bent_biogen_susp_ship_pred <- merge(bent_biogen_susp_ship, bent_pred, all.x = T)

bent_biogen_susp_ship_pred_org <- merge(bent_biogen_susp_ship_pred, org, all.x = T)
 

bent_bio <- bent_biogen_susp_ship_pred_org %>% select(-c(Color, O2,pH, Amon_N, Nitrit_N, Nitrat_N, Total_N, Mineral_P, Total_P, Si, Organic_N, Organic_P, Suspended_matter, Ships, Distance_Dump, Distance_to_Drag, Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity, Fine_particles, Coarce_particles, Org_Aug_20))


bent_env <- bent_biogen_susp_ship_pred_org %>% select(c(Station,  Color, O2,pH, Amon_N, Nitrit_N, Nitrat_N, Total_N, Mineral_P, Total_P, Si, Organic_N, Organic_P,  Depth, Transparency, Surf_Salinity, Bot_Salinity, Surf_Turbidity, Bot_Turbidity, Fine_particles, Coarce_particles,  Org_Aug_20))

bent_techno <- bent_biogen_susp_ship_pred_org %>% select(Suspended_matter, Ships, Distance_Dump, Distance_to_Drag)

bent_coord <- merge(bent_env, stat_full %>% select(Station, Long, Lat), all.x = T) %>% select(Station, Long, Lat)

# nrow(bent_coord)

```


```{r}
total_B <- bent_B %>% mutate(Total_B = rowSums(.[,-1])) %>% select(Station, Total_B)

total_N <- bent_N %>%  mutate(Total_N = rowSums(.[,-1])) %>% select(Station, Total_N)


total_B <- merge(total_B, bent_coord) %>% mutate(Anomaly = case_when(Total_B > mean(Total_B) ~ "High", Total_B <= mean(Total_B) ~ "Low"))

total_N <- merge(total_N, bent_coord) %>% mutate(Anomaly = case_when(Total_N > mean(Total_N) ~ "High", Total_N <= mean(Total_N) ~ "Low"))

Pl_B <- Pl_Obskaya_bay + 
  geom_point(data = total_B, aes(x = Long, y = Lat, group = 1, size = (Total_B), fill = Anomaly), shape = 21) +
  scale_fill_manual(values = c("red", "gray")) + 
  labs(size = "Биомасса \n(г/кв.м)") +
  guides(fill = "none")

Pl_N <- Pl_Obskaya_bay + 
  geom_point(data = total_N, aes(x = Long, y = Lat, group = 1, size = (Total_N), fill = Anomaly), shape = 21) +
  scale_fill_manual(values = c("red", "gray")) + 
  labs(size = "Плотность \n(экз./кв.м)") +
  guides(fill = "none")



```




```{r}




Spec_abund <- bent_N %>% select(-Station) %>% colSums(.) %>% t() %>% as.vector() 

spec_total_abund <- data.frame(Sp = bent_bio %>% select(-Station) %>% colnames(), Spec_abund)

N_porog <- 500 

spec_selected <- spec_total_abund %>% filter(Spec_abund > N_porog)

bent_bio_short <- bent_bio %>% select(spec_selected$Sp)



```



## Выявление нарушенных сообществ зообетоса


```{r}
total_B_N <- merge(total_N %>% select(-Anomaly), total_B %>% select(-Anomaly))

library(mixtools)

x <- log(total_B_N$Total_B)
model <- normalmixEM(x=x, verb = F)


index.lower <- which.min(model$mu)  # Index of component with lower mean


find.cutoff <- function(proba=0.5, i=index.lower) {
  ## Cutoff such that Pr[drawn from bad component] == proba
  f <- function(x) {
    proba - (model$lambda[i]*dnorm(x, model$mu[i], model$sigma[i]) /
               (model$lambda[1]*dnorm(x, model$mu[1], model$sigma[1]) + model$lambda[2]*dnorm(x, model$mu[2], model$sigma[2])))
  }
  return(uniroot(f=f, lower=-1, upper=10)$root)  # Careful with division by zero if changing lower and upper
}


# Предсказанная моделью граница двух распределений
cutoffs <- c(find.cutoff(proba=0.25))  # Around c(1.8, 1.5)



n1 = round(length(x) * model$lambda[1])
mean1 = model$mu[1]
sd1 = model$sigma[1]

binwidth = 0.5 # passed to geom_histogram and stat_function

n2 = round(length(x) * model$lambda[2])
mean2 = model$mu[2]
sd2 = model$sigma[2]

Pl_B_distr <- 
ggplot(total_B_N, aes(x = log(Total_B) )) + geom_histogram( binwidth = binwidth, fill = "gray", color = "black") +  stat_function(fun = function(x) dnorm(x, mean = mean1, sd = sd1) * n1 * binwidth, color = "darkred", size = 1) + stat_function(fun = function(x) dnorm(x, mean = mean2, sd = sd2) * n2 * binwidth, color = "darkred", size = 1)  + xlim(-2.5, 7) + geom_vline(xintercept = cutoffs)
  
  
  
  
```

Одним из самых очевидных признаков нарушенного местообитания является низкое, по сравнению с ненарушенными областями, обилие организмов в сообществе. Наиболее адекватной оценкой обилия  было бы описание их продукционных характеристик. В нарушенном сообществе продукция должна быть низкой. Поэтому в качестве показателя, приближенно связанного с продукционными характеристиками сообщества, целесообразно использовать суммарную биомассу организмов. На рисунке (`r figRef("B_distr")`) представлено  частотное распределение значений логарифма суммарной биомассы всех донных животных на станции. Распределение этой величины имеет явный бимодальный характер. С помощью алгоритма, основанного на разделении смешанных распределений на отдельные совокупности (Bengalia et al., 2009), эмпирическое распределение было аппроксимировано совокупностью двух нормальных распределений ((`r figRef("B_distr")`)). Параметры подобранных с помощью алгоритма двух аппроксимирующих распределений следующие: $\mu_1=$ `r round(mean1, 3)`, $\sigma_1=$ `r round(sd1,3)`, $\mu_2=$ `r round(mean2, 3)`, $\sigma_2=$ `r round(sd2,3)`.  

Левый пик  соответствует сообществам с биомассой, существенно меньшей, нежели биомасса фонового биоценотического покрова. Предположительно это станции, находящиеся в нарушенных местообитаниях. Если в качестве порога отнесения станции к левому пику взять границу третьего квартиля аппроксимирующего его распределения ($log(B_{Total})=$ `r cutoffs`) то сообщества, в которых суммарная биомасса оказывается меньше `r round(exp(cutoffs), 1)` г/м^2^) можно условно считать нарушенными. На самом деле это условная граница и для некоторых естественных сообществ в данной акватории это значение может находится в пределах  нормы.    



```{r fig.cap=figRef("B_distr", "Распределение суммарной биомассы бентоса на станциях. Приведены аппроксимирующие нормальные распределения. Вертикальная линия проходит через третий квартиль левого пика. ")}

Pl_B_distr + geom_text(aes(x = -0.8, y = 12, label = "Потенциально \nнарушенные \nсообщества")) + labs(x = "Логарифм суммарной биомассы", y = "Количество станций")

```





```{r}
total_B_N <- total_B_N %>% mutate(Type_ = ifelse(log(Total_B) <= cutoffs, "Disturbed", "Native"))

disturbed <- total_B_N %>% filter(Type_ == "Disturbed")

Tambey_y = 71.474355
Tambey_x = 71.813562

Seyakha_y = 70.160113
Seyakha_x = 72.533310

Pl_disturbed <-   
Pl_Obskaya_bay + geom_point(data = total_B_N %>% filter(Type_ == "Disturbed"), aes(x = Long, y = Lat, group = 1), size = 2)

```


К числу станций, формующих левый пик в распределения относятся следующие: `r disturbed$Station`. Можно заметить, что большинство станций из этой группы находятся в зоне техногенного воздействия (`r figRef("disturbed")`)  



```{r fig.cap=figRef("B_distr", "Станции, на которых отмечено аномально низкая суммарная биомасса бентоса")}

Pl_disturbed
```



## Выявление видов индикаторов нарушений



```{r}

bent_env2 <- merge(bent_env, total_B_N, by = "Station")
bent_bio2 <- cbind(bent_bio_short, total_B_N %>% select(Station, Type_))

Mod_cca <- cca(log(bent_bio_short + 1) ~ Type_ + Bot_Salinity, data = bent_env2)




# summary(Mod_cca)

```

Из четырех изученных типов сообществ (Бактериопланктон, Фитопланктон, Зоопланктон и Зообентос), наиболее чутко на присутствие техногенной взвеси, как основного нарушающего фактора, реагировали параметры бактериопланктона и зообентоса. Фитопланктон был очень малочисленен в изученной акватории и демонстрировал связь с техногенным влиянием только в непосредственной близости от источника воздействия. Реакций зоопланктона уловить не удалось. Оценка обилия бактериопланктона достаточно трудоемка. В связи с этим, поиск индикаторов техногенного воздействия надо проводить среди бентосных организмов.    

Под видами-индикаторами нарушений будем понимать такие формы, относительное обилие которых оказывается достаточно высоким в нарушенных сообществах. Для объективного выделения таких видов была рассчитана модель ординации видов зообентоса в осях канонического корреспондентного анализа (`r figRef("CCA")`), в котором в качестве предикторов выступала придонная соленость (Bot_Salinity, этот фактор должен был дифференцировать сообщества, связанные с морскими и опресненными водными массами) и тип станции (Type). Категориальный предиктор *Type* имел две градации: Disturbed для станций, значения суммарной биомассы в которых формировали левый пик (`r figRef("B_distr")`) и *Native* для станций со значениями биомасс, попадающими в правый пик распределения (`r figRef("B_distr")`). Выделенные в результате анализа две канонические оси были статистически значимы. Первая каноническая ось была связана с соленостью. Положение центроидов фактора *Type* позволяет трактовать вторую каноническую ось, характеризующую разделение станций в соответствии разделением на пики в распределении суммарной биомассы. Центроид, соответствующий группе Disturbed, занимает положение в первом квадранте ординации. Соответственно, виды, представленные на ординации, попадающие в это квадрант, с высокой вероятностью могут быть отнесены к числу индикаторов аномально низкой биомассы. К таким формам относятся полихеты *Marenzelleria* spp., сипункулиды и изоподы *Saduria entomon*. В тех местах, где данные виды достаточно обильны можно ожидать присутствие нарушений. Все три вида демонстрируют максимумы обилия в местах ассоциированных с потенциальными источниками антропогенного воздействия (`r figRef("indicators")`).  

Два вида, попадающие во второй квадрант ординации (*Portlandia aestuariorum*, *Diastylis sulcata*) нельзя отнести к числу индикаторов, так как они на ординации достаточно далеко располагаются от центроида *Disturbed*.  

```{r fig.cap=figRef("CCA", "Ординация видов в канонических корреспондентных осях.")}

plot(Mod_cca, display = c("cn", "species"), type = "t", scaling = "symmetric")

```



```{r}
Pl_Merenc <-
Pl_Obskaya_bay + geom_point(data = bent_env2, aes(x = Long, y = Lat, size = bent_bio2$Marenzelleria_sp., group = 1, color = log(bent_bio2$Marenzelleria_sp.+1) ) ) + scale_color_gradient(low = "white", high = "black") + guides(color = FALSE) + labs(size ="") + ggtitle("Marenzelleria spp.")


Pl_Sipunc <-
Pl_Obskaya_bay + geom_point(data = bent_env2, aes(x = Long, y = Lat, size = bent_bio2$Sipunculidea_gen._sp., group = 1, color = log(bent_bio2$Sipunculidea_gen._sp.+1) ) ) + scale_color_gradient(low = "white", high = "black") + guides(color = FALSE) + labs(size ="") + ggtitle("Sipunculida gen. sp.")


Pl_Sadur <-
Pl_Obskaya_bay + geom_point(data = bent_env2, aes(x = Long, y = Lat, size = bent_bio2$Saduria_entomon, group = 1, color = log(bent_bio2$Saduria_entomon +1) ) ) + scale_color_gradient(low = "white", high = "black") + guides(color = FALSE) + labs(size ="") + ggtitle("Saduria entomon")



```


```{r fig.cap=figRef("indicators", "Станции, на которых отмечены виды потенциальные индикаторы нарушения сообществ. Размер точек и интенсивность заливки пропорциональны численности вида на станции. Станции с нулевыми значениями обилия видов не прорисованы.")}

plot_grid(Pl_Merenc, Pl_Sipunc, Pl_Sadur, nrow = 1)

```


Литература

Benaglia, T., Chauveau, D., Hunter, D. R., and Young, D. mixtools: An R package for analyzing finite mixture models. Journal of Statistical Software, 32(6):1-29, 2009.

