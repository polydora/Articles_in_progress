---
title: "Виды-индикаторы водных масс в Обской губе"
author: ''
date: ''
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)


```

```{=html}
<style type="text/css">

body{ /* Normal  */
      font-size: 18px;
  }
td {  /* Table  */
  font-size: 14px;
}
h1.title {
  font-size: 38px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 28px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
```
```{r}
# Packages ######################
library(ggmap)
library(mapproj)
library(maps)

library(rgeos) 

library(mapdata)
library(maptools) # Rgshhs
library(PBSmapping)

library(readxl)
library(dplyr)
library(cowplot)
library(mgcv)
library(reshape2)
library(ggplot2)
library(ggrepel)

library(png)

library(vegan)

library(broom)
library( broom.mixed)


library(ggvegan)
library(car)


theme_set(theme_bw())
```

```{r}

# Функция, задающая нумерацию рисунков

figRef <- local({
    tag <- numeric()
    created <- logical()
    used <- logical()
    function(label, caption, prefix = options("figcap.prefix"), 
        sep = options("figcap.sep"), prefix.highlight = options("figcap.prefix.highlight")) {
        i <- which(names(tag) == label)
        if (length(i) == 0) {
            i <- length(tag) + 1
            tag <<- c(tag, i)
            names(tag)[length(tag)] <<- label
            used <<- c(used, FALSE)
            names(used)[length(used)] <<- label
            created <<- c(created, FALSE)
            names(created)[length(created)] <<- label
        }
        if (!missing(caption)) {
            created[label] <<- TRUE
            paste0(prefix.highlight, prefix, " ", i, sep, prefix.highlight, 
                " ", caption)
        } else {
            used[label] <<- TRUE
            paste(prefix, tag[label])
        }
    }
})

options(figcap.prefix = "Рисунок", figcap.sep = ".", figcap.prefix.highlight = "**")


```

```{r}

# Data reading ####################

Ob_df <- read.csv("Data/Obskaya_bay_map.csv") # Map poligones

# All Station position
stations <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Station parameters", na = "NA")

# Stations with biological samples
stat_full <- stations %>% filter(Exclude == 0)

stat_full <- as.data.frame(stat_full)

# Data on organic matter from the file "Содержание органического вещества в ДО.docx"

org <- read.csv("Data/Organic matter_2020.csv")

org <- org[org$Station %in% stat_full$Station, ]

# Data on Granulmetric from the file "Грансостав ДО.docx"

granul <- read_excel("Data/Granulometry_2020.xlsx",  na = "NA")


granul$Small <- with(granul, F_0.002 + `F_0.01-0.002` + `F_0.05-0.01`)              

granul$Big <- rowSums(granul[ ,8:15]  )


granul$Season <- factor(granul$Season)


# Chlorophyll a 

chlor <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Chlorophyll august 2020", na = "NA")


# Biogenes

biogen <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Biogenes_August", na = "NA")

biogen_full <- biogen %>% filter(Exclude == 0) %>% select(-Exclude)

biogen_full_melt <- melt(biogen_full, id.vars = c("Station", "Layer"))

biogen_full_2 <- dcast(biogen_full_melt, Station ~ Layer + variable )



# Zooplancton

zoopl_long <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Zooplancton_long", na = "NA")

zoopl <- dcast(zoopl_long %>%select(-B), Station ~ Taxa) 

zoopl[is.na(zoopl)] <- 0

zoopl$Station_ID <- as.numeric(gsub("O","", zoopl$Station))

zoopl <- zoopl[order(zoopl$Station_ID), ] %>% select(-Station_ID)


# Ship activity and Sattelite data on suspended matter and distances to dumping

# ships <- read.table("Data/Stations_tsm_ships.shp.txt", header = T, sep = "\t")
# write.table(ships, "clipboard", sep = "\t")

ships <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Ship_activity")

ships <- ships %>% filter(Exclude != 1) %>% select(Station, Ships, Distance_Dump, Distance_to_Drag)

ships2 <- merge(stat_full %>% select(Station, Lat, Long), ships)

ships2$Station_ID <- as.numeric(gsub("O","", ships2$Station))

ships2 <- ships2[order(ships2$Station_ID), ] %>% select(-Station_ID)


# nrow(ships2)


# All chlorophyll
chlorophyll <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Chlorophyll august 2020")

# Suspensed matter

suspensed_metter_by_layers <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Suspensed matters August", na = "NA")

suspensed_metter_by_layers <- suspensed_metter_by_layers %>% filter(Exclude !=1) %>% select(-Exclude)  



# Phytoplancton Species

phytopl_long <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Phytoplancton Species long")



```

```{r}
# Подготовка таблицы предикторов ####################################
predictors <- stat_full %>% select(Station, Lat, Long,  Depth_aug_20, Transparency_aug_20, Surface_Salinity_Aug_20, Bottom_Salinity_Aug_20, Surface_Turbidity_Aug_20, Bottom_Turbidity_Aug_20, Surface_Susp_Aug_20, Interm_Susp_Aug_20, Bottom_Susp_Aug_20)


chlor_surface <- chlor %>% filter(Layer == "Surface") %>% select(Station, Chla) %>% rename(Chla_surface = Chla)


chlor_intermed <- chlor %>% filter(Layer == "Intermediate") %>% select(Station, Chla) %>% rename(Chla_intermed = Chla)

chlor_bottom <- chlor %>% filter(Layer == "Bottom") %>% select(Station, Chla) %>% rename(Chla_bottom = Chla)



predictors2 <- merge(predictors, chlor_surface, all.x = T)

predictors3 <- merge(predictors2, chlor_intermed, all.x = T)

predictors4 <- merge(predictors3, chlor_bottom, all.x = T)


predictors5 <- merge(predictors4, org %>% select(Station, Org_Aug_20), all.x = T)


predictors6 <- merge(predictors5, granul %>% filter(Season == "August") %>% select(Station, Small, Big) %>% rename(Fine_particles = Small, Coarce_particles = Big), all.x =T)


predictors7 <- merge(predictors6, biogen_full_2, all.x = T)


# # All variables from intermediate layer will be excluded from analysis 
# 
# predictors8 <- predictors7 %>% select(-c(Interm_Susp_Aug_20, Chla_intermed, Intermediate_Color, Intermediate_O2, Intermediate_pH,  Intermediate_Amon_N, Intermediate_Nitrit_N, Intermediate_Nitrat_N, Intermediate_Total_N, Intermediate_Mineral_P, Intermediate_Toal_P, Intermediate_Si, Intermediate_Organic_N, Intermediate_Organic_P))

predictors8 <- merge(predictors7, ships2 %>% select(Station, Ships, Distance_Dump, Distance_to_Drag, ))

# nrow(ships2)
# Variable names cleaning

var_names <- names(predictors8)

var_names <- gsub("Bottom", "Bot", var_names)

var_names <- gsub("Surface", "Surf", var_names)

var_names <- gsub("Intermediate", "Int", var_names)

var_names <- gsub("_aug_20", "", var_names)

var_names <- gsub("_Aug_20", "", var_names)


names(predictors8) <- var_names

complete_stations <- nrow(predictors8[complete.cases(predictors8),])

NA_present <- predictors8 %>% summarise_all(funs(sum(is.na(.)))) %>% t() %>% as.data.frame()%>% mutate(Param = row.names(.))

library(imputeTS)
predictors9 <- na_mean(predictors8)

predictors9$Station_ID <- as.numeric(gsub("O","", predictors9$Station))

predictors10 <- predictors9[order(predictors9$Station_ID), ] %>% select(-Station_ID)

# nrow(predictors10)
```

```{r}
# Рабочая таблица по фитопланктону
phytopl_long2 <- phytopl_long %>% select(-Taxa_2) %>% filter(Layer == "Bottom") 


phytopl_wide <- dcast(phytopl_long2, Station  ~ Taxa_1, sum) 

# phytopl_wide %>% select(-Station) %>% rowSums(.)


```

```{r}

Watermass <- phytopl_wide %>% select(Station) %>% merge(., predictors10) %>% select(Station, Bot_Salinity) 

Watermass$Watermass <- case_when(Watermass$Bot_Salinity < 5 ~ "Fresh", Watermass$Bot_Salinity >= 5 & Watermass$Bot_Salinity < 15 ~ "Inter", Watermass$Bot_Salinity >= 15 ~ "Marine")


fresh_stations <- Watermass %>% filter(Watermass == "Fresh") %>% select(Station) %>% as.data.frame() %>% .$Station

inter_stations <- Watermass %>% filter(Watermass == "Inter") %>% select(Station) %>% as.data.frame() %>% .$Station

marine_stations <- Watermass %>% filter(Watermass == "Marine") %>% select(Station) %>% as.data.frame() %>% .$Station


```

## Водные массы в Обской губе

Как и в любом эстуарии, водные массы в Обской губе имеют двойственное происхождение: морское и речное. Имеющийся в распоряжении материал позволяет лишь приблизительно охарактеризовать параметры водных масс. При этом очевидное для эстуариев слоистое расположение водных масс (вертикальный градиент) осложняется в акватории Обской губы, имеющей довольно большую географическую протяженность, еще и горизонтальным градиентом. Водная масса речного происхождения занимает всю толщу воды в южной части акватории, а морская - в северной. Однако в средней части слои водных масс могут сменять друг друга во времени, занимая разные горизонты глубины. В связи с этим, объективный анализ водных масс, на имеющемся материале, возможен только при анализе придонной части водного тела. Распределение придонной солености в зависимости от глубины (`r figRef("water_mass")`), действительно, позволяет выделить несколько групп точек, соответствующих трем водным массам, границы между которыми, на данном этапе исследования, условны:

-   Водная масса речного происхождения (соленость меньше 5 промилле);
-   Водная масса морского происхождения (соленость более 15 промилле);
-   Промежуточная водная масса (соленость от 5 до 15 промилле).

Придонная вода речного происхождения была отмечена на следующих станциях: `r fresh_stations`.

Придонная вода морского происхождения была отмечена на следующих станциях: `r marine_stations`.

Придонная вода промежуточного типа была отмечена на следующих станциях: `r marine_stations`.

Следует отметить, что промежуточная водная масса привязана к наибольшим глубинам. Возможно, что это опресненная вода морского происхождения, сохранившаяся в ямах со времени захода в акваторию языка морской воды.

```{r fig.cap=figRef("water_mass", "Соленость придонного слоя воды на разных глубинах Обской губы")}
ggplot(predictors10, aes(x = Depth, y = Bot_Salinity)) + geom_point()  + labs(x = "Глубина (м)", y = "Соленость")
```

## Виды фитопланктона индикаторы водных масс

Для выявления видов фитопланктона, характерных для морской и речной водной массы была построена модель, описывающая распределение видов, обнаруженных в придонном слое воды, в канонических корреспондентных осях. В данной модели в качестве предиктора была использована только соленость придонного слоя воды. Соответственно, первая, и единственная, каноническая ось была связана с соленостью (`r figRef("CCA_phyto")`). Виды, сосредоточенные в левой части ординации, - это организмы, обилие которых достигает максимума при высокой солености. Противоположное положение на ординации занимают виды, тяготеющие к водной массе речного происхождения. Для выделения групп видов, наиболее сильно скоррелированных с соленостью, в качестве границ, отсекающих их от других видов, были взяты значения первого и третьего квартилей нагрузок видов по первой канонической оси.

```{r}
phyt_cca_full <- cca((phytopl_wide[ ,-1]) ~ Bot_Salinity, data = Watermass)

# plot(phyt_cca_full)

# vif.cca(phyt_cca_full)

# anova(phyt_cca_full, by = "axis")



CCA_scores <- fortify(phyt_cca_full)


CCA_scores_sp <- CCA_scores %>% filter(Score == "species") 



# %>% ggplot(., aes(CCA1)) + geom_histogram(binwidth = 0.2)





```

```{r fig.cap=figRef("CCA_phyto", "Ординация видов фитопланктона вдоль первой канонической оси и первой корреспондентной оси")}
plot(phyt_cca_full, display = c("species", "cn"), type = c("p"), scaling = "species")
```

```{r}
Quant_CCA1 <- quantile(CCA_scores_sp$CCA1, probs = c(0.25, 0.75))

taxa <- phytopl_long %>% select(Taxa_1, Taxa_2) %>% unique(.)

marine_indicators <- CCA_scores_sp %>% filter(CCA1 <= Quant_CCA1[1]) %>% select(Label) %>% rename(Taxa_1 = Label) %>% merge(., taxa, all.x = T)

marine_indicators2 <-  phytopl_long2 %>% filter(Taxa_1 %in% marine_indicators$Taxa_1) %>% group_by(Station) %>% summarise(N_all = sum(N)) %>% merge(Watermass, ., all.x = T) %>% mutate(N_indicators = ifelse(is.na(N_all), 0, N_all))


fresh_indicators <- CCA_scores_sp %>% filter(CCA1 >= Quant_CCA1[2]) %>% select(Label) %>% rename(Taxa_1 = Label) %>% merge(., taxa, all.x = T)



fresh_indicators2 <-  phytopl_long2 %>% filter(Taxa_1 %in% fresh_indicators$Taxa_1) %>% group_by(Station) %>% summarise(N_all = sum(N)) %>% merge(Watermass, ., all.x = T) %>% mutate(N_indicators = ifelse(is.na(N_all), 0, N_all))

fresh_indicators$Taxa_1 <- gsub("_", " ", fresh_indicators$Taxa_1)

marine_indicators$Taxa_1 <- gsub("_", " ", marine_indicators$Taxa_1)


```

Согласно введенному критерию разделения, к числу идикаторов морской водной массы относятся следующие таксоны.

```{r}
kable(marine_indicators, col.names = c("Виды", "Таксон более высокого ранга"))
```

К числу индикаторов пресной водной массы относятся следующие формы.

```{r}
kable(fresh_indicators, col.names = c("Виды", "Таксон более высокого ранга"))
```

Суммарное обилие видов из обеих групп закономерно связано с типом водных масс ( `r figRef("phyto_indicators_abund")`). Важно отметить, что промежуточная водная масса, судя по обилию индикаторов, скорее должна классифицироваться как пресноводная.

```{r fig.cap=figRef("phyto_indicators_abund", "Обилие видов-индикаторов из группы витов фитопланктона в разных водных массах")}


Pl_phyt_marine_indicators <- 
ggplot(marine_indicators2, aes(x = Watermass, y = N_indicators)) + geom_boxplot() + labs(x = "Водная масса", y = "Суммарная численность видов индикаторов") + ggtitle("Индикаторы водной массы \nморского происхождения")

Pl_phyt_fresh_indicators <-
ggplot(fresh_indicators2, aes(x = Watermass, y = N_indicators)) + geom_boxplot()+ labs(x = "Водная масса", y = "Суммарная численность видов индикаторов") + ggtitle("Индикаторы водной массы \nречного происхождения")


plot_grid(Pl_phyt_marine_indicators, Pl_phyt_fresh_indicators, nrow = 1)
```

## Виды зоопланктона индикаторы водных масс

Принцип выделения видов-индикаторов водных масс среди зоопланктона был аналогичен описаному выше. Однако, поскольку сбор планктона проводился во всей толще воды, то точной привязки к водным массам тех или иных видов может не наблюдаться. Это связано с тем, что, при наличии вертикальной стратификации водных масс, взятие пробы путем протяжки через весь столб воды, приводит к смешению сообществ. Однако на ординации достаточно четко выделяется две группы видов по-разному связанными с соленостью (`r figRef("CCA_zoopl")`)

```{r}

zoopl_long <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Zooplancton_long", na = "NA")


zoopl_wide <- dcast(zoopl_long %>% select(-B), Station  ~ Taxa, sum) 




Watermass <- zoopl_wide %>% select(Station) %>% merge(., predictors10) %>% select(Station, Bot_Salinity) 

Watermass$Watermass <- case_when(Watermass$Bot_Salinity < 5 ~ "Fresh", Watermass$Bot_Salinity >= 5 & Watermass$Bot_Salinity < 15 ~ "Inter", Watermass$Bot_Salinity >= 15 ~ "Marine")


```

```{r}
zoopl_cca_full <- cca((zoopl_wide[ ,-1]) ~ Bot_Salinity, data = Watermass)

# plot(phyt_cca_full)

# vif.cca(phyt_cca_full)

# anova(phyt_cca_full, by = "axis")



CCA_scores <- fortify(zoopl_cca_full)


CCA_scores_sp <- CCA_scores %>% filter(Score == "species") 

```

```{r fig.cap=figRef("CCA_zoopl", "Ординация видов зоопланктона вдоль первой канонической оси и первой корреспондентной оси")}
plot(zoopl_cca_full, display = c("species", "cn"), type = c("p"), scaling = "species")
```

```{r}
Quant_CCA1 <- quantile(CCA_scores_sp$CCA1, probs = c(0.25, 0.75))

taxa <- zoopl_long %>% select(Taxa) %>% unique(.)

marine_indicators <- CCA_scores_sp %>% filter(CCA1 <= Quant_CCA1[1]) %>% select(Label) %>% rename(Taxa = Label)


marine_indicators2 <-  zoopl_long %>% filter(Taxa %in% marine_indicators$Taxa) %>% group_by(Station) %>% summarise(N_all = sum(N)) %>% merge(Watermass, ., all.x = T) %>% mutate(N_indicators = ifelse(is.na(N_all), 0, N_all))


fresh_indicators <- CCA_scores_sp %>% filter(CCA1 >= Quant_CCA1[2]) %>% select(Label) %>% rename(Taxa = Label) 


fresh_indicators2 <-  zoopl_long %>% filter(Taxa %in% fresh_indicators$Taxa) %>% group_by(Station) %>% summarise(N_all = sum(N)) %>% merge(Watermass, ., all.x = T) %>% mutate(N_indicators = ifelse(is.na(N_all), 0, N_all))

fresh_indicators$Taxa <- gsub("_", " ", fresh_indicators$Taxa)

marine_indicators$Taxa <- gsub("_", " ", marine_indicators$Taxa)


```

Согласно введенному критерию разделения, к числу индикаторов морской водной массы относятся следующие таксоны.

```{r}
kable(marine_indicators, col.names = c("Виды"))
```

К числу индикаторов пресной водной массы относятся следующие формы.

```{r}
kable(fresh_indicators, col.names = c("Виды"))
```

Суммарное обилие видов из обеих групп закономерно связано с типом водных масс ( `r figRef("zoopl_indicators_abund")`): виды-индикаторы водных масс речного происхождения обильны лишь на станциях, где представлена пресная и промежуточная водная масса, морские виды-индикаторы, соответственно, в водной массе морского происхождения.

```{r fig.cap=figRef("zoopl_indicators_abund", "Обилие видов-индикаторов из числа зоопланктона в разных водных массах")}


Pl_zoopl_marine_indicators <- 
ggplot(marine_indicators2, aes(x = Watermass, y = N_indicators)) + geom_boxplot() + labs(x = "Водная масса", y = "Суммарная численность видов индикаторов") + ggtitle("Индикаторы водной массы \nморского происхождения")

Pl_zoopl_fresh_indicators <-
ggplot(fresh_indicators2, aes(x = Watermass, y = N_indicators)) + geom_boxplot()+ labs(x = "Водная масса", y = "Суммарная численность видов индикаторов") + ggtitle("Индикаторы водной массы \nречного происхождения")


plot_grid(Pl_zoopl_marine_indicators, Pl_zoopl_fresh_indicators, nrow = 1)
```

## Виды зообентоса индикаторы водных масс

Поиск видов-индикаторов водных масс среди зообентоса должен сопровождаться целым рядом оговорок. Во-первых, бентосные животные живут дольше большинства планктонных организмов и, соответственно, их популяции менее подвержены кратковременным изменениям, связанным с перемещениями водных масс. Во-вторых, многие донные животные, обитающих в эстуариях, являются осморегуляторами и обладают адаптациями, позволяющими переносить значительные перепады солености. В-третьих, соленость может быть заметным лимитирующим фактором только для морских форм, пресноводные же многоклеточные организмы легче переносят осолонение. Иными словами, увеличение притока пресной воды может быть фатальным для морских форм, но заход морских вод в пресноводные участки для бентосных организмов не столь чувствителен. В-четвертых, в биоценотическом покрове дна в Обской губе очень выражено пятнистое распределение организмов, связанное с локальными нарушениями разной природы. Эта мозаика может маскировать градиенты, связанные с распределением водных масс.

Все сказанное значительно сокращает вероятность правильного определения роли видов, как индикаторов водных масс. Однако ординация, проведенная по тем же принципам, что и в предыдущих случаях, позволяет увидеть четко очерченную группу морских видов и несколько групп, связанных с опресненными водами.

```{r}
bent <- read_excel("Data/Obskaya_bay_2020.xlsx", sheet = "Benthos")


bent_B <- bent %>% filter(Type == "Biomass") %>% select(-Type)

bent_N <- bent %>% filter(Type == "Abundance") %>% select(-Type)



Watermass <- bent_N %>% select(Station) %>% merge(., predictors10) %>% select(Station, Bot_Salinity) 

Watermass$Watermass <- case_when(Watermass$Bot_Salinity < 5 ~ "Fresh", Watermass$Bot_Salinity >= 5 & Watermass$Bot_Salinity < 15 ~ "Inter", Watermass$Bot_Salinity >= 15 ~ "Marine")


```

```{r}

Spec_abund <- bent_N %>% select(-Station) %>% colSums(.) %>% t() %>% as.vector() 

spec_total_abund <- data.frame(Sp = bent_N %>% select(-Station) %>% colnames(), Spec_abund)

N_porog <- 500

N_porog2 <- round(500/nrow(bent_N))

spec_selected <- spec_total_abund %>% filter(Spec_abund > N_porog)

bent_short <- bent_N %>% select(spec_selected$Sp)


bent_cca_full <- cca(bent_short ~ Bot_Salinity, data = Watermass)

# plot(phyt_cca_full)

# vif.cca(phyt_cca_full)

# anova(phyt_cca_full, by = "axis")



CCA_scores <- fortify(bent_cca_full)

CCA_scores_sp <- CCA_scores %>% filter(Score == "species") 



```

```{r fig.cap=figRef("CCA_phyto", "Ординация видов зообентоса вдоль первой канонической оси и первой корреспондентной оси. В анализе использованы только обильные виды, включенные ранее в анализ сообществ зообентоса (см. соответствующую часть отчета)")}

plot(bent_cca_full, display = c("species", "cn"), type = c("p"), scaling = "species")

```

```{r}
Quant_CCA1 <- quantile(CCA_scores_sp$CCA1, probs = c(0.25, 0.75))

taxa <- bent_N %>% colnames() 

marine_indicators <- CCA_scores_sp %>% filter(CCA1 <= Quant_CCA1[1]) %>% select(Label) %>% rename(Taxa = Label)


marine_indicators2 <-  bent_N %>% select(marine_indicators$Taxa) %>% mutate(N_indicators = rowSums(.)) %>% cbind(Watermass, .) 


fresh_indicators <- CCA_scores_sp %>% filter(CCA1 >= Quant_CCA1[2]) %>% select(Label) %>% rename(Taxa = Label)


fresh_indicators2 <-  bent_N %>% select(fresh_indicators$Taxa) %>% mutate(N_indicators = rowSums(.)) %>% cbind(Watermass, .) 


fresh_indicators$Taxa <- gsub("_", " ", fresh_indicators$Taxa)

marine_indicators$Taxa <- gsub("_", " ", marine_indicators$Taxa)


```

К числу индикаторов морской водной массы относятся следующие таксоны.

```{r}
kable(marine_indicators, col.names = c("Виды"))
```

Опресненную водную массу маркируют следующие виды.

```{r}
kable(fresh_indicators, col.names = c("Виды"))
```

Подчеркнем еще раз, что эти формы, скорее, маркеры эстуарных условий, чем пресноводных.

Суммарное обилие видов из обеих групп на станциях с придонной водой, относящейся к разным водным массам ( `r figRef("bent_indicators_abund")`), как и в предыдущих случаях, демонстрирует корреляцию с водными массами, однако эта связь выражена заметно слабее, чем в случае с планктонными формами.

```{r fig.cap=figRef("bent_indicators_abund", "Обилие видов-индикаторов зообентоса в разных водных массах")}


Pl_bent_marine_indicators <- 
ggplot(marine_indicators2, aes(x = Watermass, y = log(N_indicators+1) )) + geom_boxplot() + labs(x = "Водная масса", y = "Логарифм суммарной численности видов индикаторов") + ggtitle("Индикаторы водной массы \nморского происхождения")

Pl_bent_fresh_indicators <-
ggplot(fresh_indicators2, aes(x = Watermass, y = log(N_indicators+1) )) + geom_boxplot()+ labs(x = "Водная масса", y = "Логарифм суммарной численности видов индикаторов") + ggtitle("Индикаторы водной массы \nречного происхождения")


plot_grid(Pl_bent_marine_indicators, Pl_bent_fresh_indicators, nrow = 1)
```
