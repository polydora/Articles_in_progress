---
title: "Пространственные паттерны в отловах птиц"
output: html_document
date: "2025-03-22"
---

```{r setup, include=FALSE}
library(knitr)

opts_chunk$set(echo = FALSE, message = FALSE)
```


```{r}
library(vegan)
library(dplyr)
library(broom)
library(readxl)
```



В качестве матрицы для анализа я взял просто сырые данные по количеству отловов, as is. Возможо надо далее смотреть на годы, месяцы и т.д. Это пока первый заход. По сути дела я лишь просто нарисовал исходные данные в канонических осях. 

Для построения ординации я применил Canonical correspondence analysis (CCA). Выбор именно этой формы канонической ординации, а не RDA, например, основан лишь на том, что этот метод чуть лучше заточен для данных в форме численностей. С техникой орднации еще можно поиграться.

В качестве предикторов в модели CCA были использованы географические координаты точек отлова. Соответственно, модель выглядит вот так

$$
Data.matrix \sim N + E
$$



```{r}
bird <- read_excel("Table1.xls", sheet = "Лист2")

bird <- as.data.frame(bird)

rownames(bird) <- bird$Site

mod <- cca(bird[,-c(1:5)] ~ N + E, data = bird)
```

Вот summary этой модели.

```{r}

sum <- summary(mod)

sum$cont$importance

```

Из всего этого принципиально важно, что географические координаты (CCA1 и CCA2) объясняют 37% инерции (типа изменчивости). Это довольно много.


Сама модель оказалась статистически значимой, что говорит о наличии географического паттерна. 

```{r}
anova(mod, permutations = 9999)
```

Из двух координат лишь долгота значимо влияет на ординацию в канонических осях.

```{r}
anova(mod, by = "margin", permutations = 9999)

```

Ну и, соответственно, только одна, CCA1, каноническая ось оказывается значимой. 

```{r}
anova(mod, by = "axis", permutations = 9999)

```



Вот результаты ординации видов в канонических осях.

```{r}
plot(mod, display = c("cn", "species"), scaling = "species", ,main = "Рис. 1. Ординация видов")
```


Здесь важно, что имеет смысл обсуждать только ординацию вдоль CCA1 (32% общей инерции), она же географическая долгота. Я здесь вижу группу видов, которые связаны с востоком (правая часть ординации) и виды, связанные с западом (левая часть ординации). Ближе к центру - те виды, которым этот градиент более или менее безразличен (точнее связь с ним слабее выражена), или/и это виды, которые чаще ловятся в центральной части этого градиента. Если справедливо последнее, то это виды, которые чаще отлавливаются на тех станциях, которые расположены ближе к географичекому центроиду (по сути - средние значения координат). В этом помогает разобраться ординация станций отлова, проведенная в тех же канонических осях.

```{r}
plot(mod, display = c("cn", "sites"), scaling = "sites",main = "Рис. 2. Ординация станций кольцевания")
```

Те станции, которые расположены ближе к оси ординат - это как раз те, где ловятся те птицы, которые, находятся ближе к началу координат. Любопытно, что станция Dzhanibek, где есть повторности в разные годы, дала такую дисперсию. Это означает, что состав "сообщества" птиц на этой станции сильно меняется (сюда, в какие-то годы, видимо, залетают чужие птицы). Так что если есть возможность ввести в таблицу разные годы для одной и той же станции, то это может дать интересные результаты.


Вернемся в ординации видов (Рис. 1). Виды, находящиеся правее всего (восточная часть), по-моему, все летят в Индию. Виды, находящиеся левее всего (западная часть), по-моему, все, кроме *малой мухоловки*, летят в Африку. 


Пока вот так. Тут еще многое можно подкручивать и настраивать. Опять же любопытно было бы включить сюда каой-нибудь еще набор предикторов, кроме географии. Например, есть такой забавный метод, который называется Biological Trait Analysis (в экологии он сейчас довольно популярен), который позволяет вытащить связь каких-то биологическийх черт видов с теми или иными экологическими (в данном случае, возможно, географическими) паттернами. 


