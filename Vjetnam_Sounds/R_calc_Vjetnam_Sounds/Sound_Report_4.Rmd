---
title: "RDA for Sound analysis"
author: "В. М. Хайтов"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(vegan)
library(dplyr)

```


Файл BD.csv я преобразовал в экселевский файл. При этом ввел более дробное разбинние времени суток на несколько категорий (Morning, Day, Evening, Nigth).

```{r}

dat <- read_excel("Short_observation.xlsx")

sound <- dat %>% select(Ins, Anur, Bird, Mam, Wind, Rain, Noise)

sound_perc <- decostand(x = sound, MARGIN = 1, method = "total") #Выражаем в представленность источников звука в долях.

predictors <- dat %>% select(Indx, Month_, Day_Part_)


```


Вот модель для Redundancy Analysis (RDA). Это такая форма многомерного анализа, в которой сочетается метод главных компонент (PCA) и линейные модели. 


```{r}

Mod <- rda(sound ~ Month_ + Day_Part_, data = predictors)

```


Вот summary от этой модели.

```{r}

summary(Mod)
```


Ниже приводятся результаты пермутационной оценки значимости самой модели, ее канонических осей и предикторов, включенных в модель.

```{r}

anova(Mod)

anova(Mod, by = "axis")

anova(Mod, by = "margin")

```


Модель сама по себе значимая. Значимы в ней первые две канонические оси, которые объясняют 30.7% общей изменчивости структуры звукового "сообщества". Все предикторры, тоже влияют на структуру "сообщества".



Теперь визуализация модели.

```{r}
plot(Mod, display = c("species", "cn"), scaling = "species")
```

Картинка вполне трактуемая. 

1. Есть два относительно независимых комплекса источников звуков. Первый это Ins VS Wind (они связаны с первой канонической осью). При этом эта картинка говорит о том, что чем больше ветра, тем меньше насекомых (и наоборот). Второй - это  Anur VS Bird (они связаны со второй канонической осью). Чем меньше Bird, тем больше  Anur (и наоборот).

2. Первая ось, которая насекомые vs  ветер, хорошо коррелирует с месяцами. Ветра много в Jan, насекомых много в Jun, Aug, Oct. 

3. Насекомые слабо связаны со временем суток (об этом говорит, что центроиды для разных времен дня вытянуты вдоль второй канонической оси, а насекомые имеют большие нагрузки по первой оси). Хотя их чуть больше к вечеру.
4. Вторая каноническая ось хорошо коррелирует со временем суток. При этом птицы более обильны утром и днем, а лягушки - вечером и ночью.

5. Включенные в модель предикторы не влияют на представленность в "сообществе" млекопитающих, шума и дождя. Эти элементы концентрируются в районе нулей по обеим каноническим осям.


Итого, структура "сообщества" звуков имеет и годовую, и суточную динамику. Зимой много ветра, но мало насекомых. Летом много насекомых и мало ветра. Лягушки и птицы меньше зависят от времени года (хотя некоторая связь есть), но делят сутки (первых больше к вечеру и в ночи, вторых - утром и днем )   


Посмотрите результаты и пройдитесь по коду (картинку лучше смотреть при большем увеличении). 
Для справки про то, что такое RDA кидаю свою презентацию для курса, который я веду для СПбГУ.
