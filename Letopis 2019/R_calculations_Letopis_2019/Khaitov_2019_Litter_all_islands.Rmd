---
title: "Распределение антропогенного мусора на литорали островов Северного архипелага "
author: "В. М. Хайтов"
output: 
      word_document:
                reference_docx: Letopis_template.docx
                fig_width: 5
                fig_height: 5

 
abstract: |
    **Хайтов В. М. Распределение антропогенного мусора на литорали островов Северного архипелага ** // Толмачева Е. Л. (ред.) Летопись природы Кадалакшского заповедника за 2019 год (ежегодный отчет). Кандалакша. Т.1 (Летопись природы Кандалакшского заповедника, кн. ++)
    Рассматриваются данные по учету мусора в полосе штормовых выбросов на островах и лудах Северного архипелага.   
    
    **Khaitov V.M. Diatribution of litter on island shore of the Severny arhipelago** // Tolmacheva E. L. (ed.)  The Chronicle of Nature by the Kandalaksha Reserve for 2019 (Annual report).  Kandalaksha. V.1. (The Chronicle of Nature by the Kandalaksha Reserve, Book N ++)
     The data on litter amount on the shoreline of islands are considered.      
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

library(reshape2)
library(knitr)
library(pander)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(ggmap)


theme_set(theme_bw())
options(figcap.prefix = "Рисунок", figcap.sep = ".", figcap.prefix.highlight = "**" )


editor <- "Толмачева Е. Л."
editor_eng <- "Tolmacheva E. L."

# Функция, задающая нумерацию рисунков

figRef <- local({
    tag <- numeric()
    created <- logical()
    used <- logical()
    function(label, caption, prefix = options("figcap.prefix"), 
        sep = options("figcap.sep"), prefix.highlight = options("figcap.prefix.highlight")) {
        i <- which(names(tag) == label)
        if (length(i) == 0) {
            i <- length(tag) + 1
            tag <<- c(tag, i)
            names(tag)[length(tag)] <<- label
            used <<- c(used, FALSE)
            names(used)[length(used)] <<- label
            created <<- c(created, FALSE)
            names(created)[length(created)] <<- label
        }
        if (!missing(caption)) {
            created[label] <<- TRUE
            paste0(prefix.highlight, prefix, " ", i, sep, prefix.highlight, 
                " ", caption)
        } else {
            used[label] <<- TRUE
            paste(prefix, tag[label])
        }
    }
})


```



```{r}
# Читаем данные
island <- read.table(file = "data/Islands_data_UTF8.csv", header = T, sep = ",")
lit <- read.table(file = "data/Litter_on_island_all_years_UTF8.csv", header = T, sep = ",")

island_lit <- merge(island, lit)

# bal$N <- bal$N/60 + 67
# bal$E <- bal$E/60 + 32

# ggRyazhkov <- read.table("data/ggRyazhkov.csv", header = T, sep = ";")

# load("data/Kand_map.RData")

```



Учет мусора на островах Северного архипелага был начат в `r min(lit$Year)` году. В период учета гнездящихся птиц (июнь) один из участников группы, работающей на острове, проходил по периметру острова по  полосе штормовых выбросов. При этом отмечались все предметы заметные без разрушения слоя выбросов. Единицей учета были отдельные предметы или их части, представленные в выбросах, как единое целое. В качестве пространственной единицы учета рассматривался весь остров. За весь период наблюдения (`r range(lit$Year)` гг) было обследовано `r length(unique(lit$Island)) - 1` островов разных размеров (кроме того, более подробному анализу подвергался о. Ряжков, см. отдельную главу настоящего тома Летописи). Параметры островов (площадь, периметр, координаты) приведены в таблице +.1. Исходные данные по учету предметов антропогенного происхождения в 2017-2019 гг приведены в таблице +.2 (данные за предыдущие годы приведены в Летописи природы за 2016 г).

Оценка удельного количества мусора (единиц на 100 м) производилась путем деления количества единиц мусора, найденного на том или ином острове, на периметр данного острова. Для анализа многолетних тенденций в динамике количества мусора на островах Северного архипелага было отобрано несколько островов, на которых учет мусора проводился не менее, чем 8 раз. `r figRef("Isl_dynam")` демонстрирует многолетние изменения в удельном количестве мусора на тех островах, где наблюдения проводились не менее, чем 8 лет (данные по о. Ряжкову не приводятся, см. отдельную главу данного тома Летописи). Отчетливых, статистически значимых, трендов в межгодовых изменениях этой величины выявить не удается. Вместе с тем, на четырех островах прослеживается тенденция к всплеску обилия мусора в 2013-2016 гг.  


```{r}
island_print <- island[order(island$Area, decreasing = T), -ncol(island)]

row.names(island_print) <- NULL

kable(island_print, col.names = c("Остров", "Площадь", "Периметр", "Широта (N)", "Долгота (E)"), caption = "**Таблица +.1**. Размеры и координаты островов, на которых производилась оценка обилия мусора (координаты приведены для точки, располагающейся в центральной части острова). Size and Coordinates of islands where the litter amount was assessed (coordinates are given for a point located in the central part of the island).")
```







```{r}
lit_print <- lit[,-ncol(lit)] %>% filter(Year >= 2017)  

lit_print[is.na(lit_print)] <- 0

lit_print$Total <- apply(lit_print[, -c(1:2)], MARGIN = 1, FUN = function(x) sum(x))

lit_print2 <- lit_print %>% group_by(Year, Island) %>% summarise_all(.funs = sum) %>%  merge(., island) %>% select(-c( "N", "E", "X"))

lit_print2$Total_Perim <- round(lit_print2$Tota / lit_print2$Perimetr *0.100, 0)
lit_print2$Area <- round(lit_print2$Area, 1)

lit_print3 <- lit_print2 %>% select(-c("Area", "Perimetr")) %>% arrange( Year)


kable(lit_print3, 
      col.names = c("Остров", "Год", "Пластиковые предметы",	"Пластиковые бутылки", "Стеклянные бутылки и битое стекло",	"Полиэтилен и целлофан",	"Покрышки и прочие резиновые предметы", "Бумага",	"Металлические предметы","Консервные банки",	"Предметы одежды",	"Пенопласт",	"Прочее", "Всего", "Единиц на 100 м"), 
      caption = "**Таблица +.2**. Количество единиц мусор на островах Северного архипелага в 2017-2019 гг. The litter amount on islands of Severny arkhipelago in 2017-2019."
)
```





```{r, fig.cap=figRef("Isl_dynam", "Динамика удельного количества единиц мусора на островах Кандалакшского залива (приведены линии тренда, аддитивные модели (GAM)).The dynamics of the number of garbage units per 100 m of shore line on the islands of Kandalaksha Bay (GAM trend lines are shown)")}


lit2 <- lit %>% group_by(Year, Island) %>% summarise_all(.funs = sum) %>%  merge(., island) %>% select(-c( "X"))

lit2$Total <- apply(lit2[ , names(lit2) %in% c("Plastic", "Plastic_botles", "Glass", "Polyetilen", "Rubber", "Paper", "Metal", "Cans", "Textil", "Foam_Plastic", "Other")], MARGIN = 1, FUN = function(x) sum(x, na.rm = T) )


lit2$Total_Perim <- lit2$Total/lit2$Perimetr


dd <- lit2 %>% group_by(Island) %>% summarise(N = n()) %>% filter(Island != "Ряжков")

isalnd_selected <- dd %>% filter(N >= 8 )

lit_dynam <- lit2 %>% filter(Island %in% isalnd_selected$Island)


library(mgcv)

M1 <- gam(Total_Perim ~ s(Year, k = 9, by = Island), data = lit_dynam)

MyData <- lit_dynam %>% group_by(Island) %>% do(data.frame(Year = seq(min(.$Year), max(.$Year), 0.1)))

Predictions_M2 <- predict(M1, newdata = MyData, type = "response", se.fit = T)

MyData$Predict_M1 <- Predictions_M2$fit

MyData$SE <- Predictions_M2$se.fit


ggplot(data = MyData, aes(x = Year, y = Predict_M1)) + geom_point(data = lit_dynam, aes(x = Year, y = Total_Perim)) + geom_ribbon(aes(ymin = Predict_M1 - 1.96*SE, ymax = Predict_M1 + 1.96*SE), alpha = 0.2) +  geom_line() + ylab("Количество единиц мусора на 100 м береговой линии") + xlab("Годы") + facet_wrap(~Island, ncol = 3) + scale_x_continuous(breaks=seq(min(lit_dynam$Year), max(lit_dynam$Year), 1)) + theme(axis.text.x = element_text(angle = 90))

```


