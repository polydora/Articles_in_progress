---
title: "Учет обилия мусора на супралиторали о. Ряжкова в 2022-2023 гг. "
author: "В. М. Хайтов"
output: 
      word_document:
                reference_docx: Letopis_template.docx
                fig_width: 5
                fig_height: 5

 
abstract: |
    **Хайтов В. М. Учет обилия мусора на супралиторали о. Ряжкова в 2022-2023 гг.** // Толмачева Е. Л. (ред.) Летопись природы Кандалакшского заповедника за 2016 год (ежегодный отчет). Кандалакша. Т.1 (Летопись природы Кандалакшского заповедника, кн. ++)
    
    Проведен количественный анализ обилия антропогенного мусора на побережье о. Ряжкова.
    
    **Khaitov V.M. The assessment of litter on the Ryazhkov island shore-line in 2022-2023** // Tolmacheva E. L. (ed.)  The Chronicle of Nature by the Kandalaksha Reserve for 2016 (Annual report).  Kandalaksha. V.1. (The Chronicle of Nature by the Kandalaksha Reserve, Book N ++)
    
    The results of quantitative analysis of litter presented on shore of Ryazhkov island are presented.
      
---


```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, dpi=300)


```



```{r setup2, include=FALSE}


library(reshape2)
library(knitr)
library(readxl)
library(dplyr)
library(ggplot2)
library(cowplot)
library(flextable)
library(officer)
library(lubridate)
library(ggmap)


editor <- "Толмачева Е. Л."
editor_eng <- "Tolmacheva E.L."

Year <- 2023

# Функция, задающая нумерацию рисунков

figRef <- local({
    tag <- numeric()
    created <- logical()
    used <- logical()
    function(label, caption, prefix = options("figcap.prefix"), 
        sep = options("figcap.sep"), prefix.highlight = options("figcap.prefix.highlight")) {
        i <- which(names(tag) == label)
        if (length(i) == 0) {
            i <- length(tag) + 1
            tag <<- c(tag, i)
            names(tag)[length(tag)] <<- label
            used <<- c(used, FALSE)
            names(used)[length(used)] <<- label
            created <<- c(created, FALSE)
            names(created)[length(created)] <<- label
        }
        if (!missing(caption)) {
            created[label] <<- TRUE
            paste0(prefix.highlight, prefix, " ", i, sep, prefix.highlight, 
                " ", caption)
        } else {
            used[label] <<- TRUE
            paste(prefix, tag[label])
        }
    }
})

options(figcap.prefix = "Рисунок", figcap.sep = ".", figcap.prefix.highlight = "**")


theme_set(theme_bw())


```


```{r}
# Читаем данные
litter <- read_excel("data/ryazhkov_litter_all_years_2008_2023.xlsx", na = "NA")
litter$N <- litter$N/60 + 67
litter$E <- litter$E/60 + 32

lit_print <- litter

ggRyazhkov <- read.table("data/ggRyazhkov.csv", header = T, sep = ";")

load("data/Ryazh_map.RData")


```


Учет мусора производился в полосе штормовых выбросов. При этом отмечались все предметы, заметные без разрушения слоя выбросов. Единицей учета были отдельные предметы или их части, представленные в выбросах, как единое целое. Координаты точки начала учета засекалась с помощью GPS-навигатора. Исходные данные по учету предметов антропогенного происхождения за 2022-2023 гг приведены в таблице +.1. Данные по обилию мусора в 2008-2019 гг были приведены в Летописи природы за 2016 и 2019 гг. 



Как показали анализы, проведенные в предыдущие годы, наиболее объективным показателем, отражающим обилие мусора, является количество пластиковых бутылок. Обилие этих предметов можно рассматривать, как маркер обилия мусора. В таблице +.2 приведены данные по суммарному количеству пластиковых бутылок и прочего антропогенного мусора на побережье о. Ряжкова. График (`r figRef("Botles")`), отражающий межгодовые изменения общего количества пластиковых бутылок и прочих предметов, обнаруженных на побережье о. Ряжкова, не демонстрирует явных многолетних тенденций. В последние годы эти величины поддерживаются на более или менее одинаковом уровне.  

Для анализа пространственного распределения мусора по побережью о. Ряжкова были построены карты (`r figRef("Space")`), на которых нанесены участки учета мусора и приведены данные по обилию пластиковых бутылок. Можно заметить, что год от года паттерн распределения обилия пластиковых бутылок изменяется. Наибольшее количество пластиковых бутылок наблюдалось в Северо-Западной части острова и в Фукусовой губе (Юго-Восточная часть).

\pagebreak

```{r}
litter$Total <- apply(litter[, -c(1:3)], 1, FUN = function(x) sum(x, na.rm= T))

litter_print <- 
  litter %>%
  select(-Total) %>% 
  filter(Year >= 2022)


colname <- c("Год", "Широта", "Долгота", "Пластиковые предметы",	"Пластиковые бутылки", "Стекло",	"Полиэтилен",	"Резиновые предметы", "Бумага",	"Металл","Консервные банки",	"Предметы одежды",	"Пенопласт",	"Прочее")
  
  
library(officer)
std_border = fp_border(color="gray", width = 1)

litter_print %>% 
 flextable() %>% 
 border_inner_h(border = std_border ) %>% 
  border_inner_v(border = std_border ) %>% 
  fontsize(size = 8, part = "all") %>% 
  set_header_labels(values = colname) %>%
  set_caption("Таблица +.1  Количество предметов антропогенного мусора, найденных на разных станциях на побережье о. Ряжкова в 2022-2023 гг. Number of antropogenic items found on the stations on Ryazhkov island shore in 2022-2023.") %>% 
  autofit()



# kable(litter_print, 
#       col.names =  c("Год", "Широта", "Долгота", "Пластиковые предметы",	"Пластиковые бутылки", "Стеклянные бутылки и битое стекло",	"Полиэтилен и целлофан",	"Покрышки и прочие резиновые предметы", "Бумага",	"Металлические предметы","Консервные банки",	"Предметы одежды",	"Пенопласт",	"Прочее"),
#       caption = "**Таблица +.1**  Количество предметов антропогенного мусора, найденных на разных станциях на побережье о. Ряжкова в 2022-2023 гг. Number of antropogenic items found on the stations on Ryazhkov island shore in 2022-2023."
# )

```


\pagebreak

```{r}
sum_year_print <- 
  litter %>% 
  group_by(Year) %>% 
  summarise(N_Botles = round(sum(Plastic_botles)), N_total = round(sum(Total) - round(sum(Plastic_botles))))

# which(is.na(litter$Year))

colname <- c("Год", "Количество пластиковых бутылок", "Общее количество единиц мусора (без бутылок)")

sum_year_print %>% 
flextable() %>% 
 border_inner_h(border = std_border ) %>% 
  border_inner_v(border = std_border ) %>% 
  fontsize(size = 8, part = "all") %>% 
  set_header_labels(values = colname) %>%
  set_caption("Таблица +.2 Общее количество единиц мусора и общее количество пластиковых бутылок, обнаруженных на побережье о. Ряжкова в разные годы. Total litter amount and number of  plastic botles found on the shore of Ryazhkov island in different years.") %>% 
  autofit()



# kable(sum_year_print, 
#       col.names = c("Год", "Количество пластиковых бутылок", "Общее количество единиц мусора (без бутылок)"), 
#       caption =  "**Таблица +.2** Общее количество единиц мусора и общее количество пластиковых бутылок, обнаруженных на побережье о. Ряжкова в разные годы. Total litter amount and number of  plastic botles found on the shore of Ryazhkov island in different years"
#       )


```


\pagebreak

```{r, fig.cap=figRef("Botles", "Общее количество единиц мусора и количество пластиковых бутылок, обнаруженных на побережье о. Ряжкова в разные годы (приведена линия тренда). Total litter amount and number of  plastic botles found on the shore of Ryazhkov island in different years (trend line is provided)"), fig.align="center"}

Pl_Total <- 
  ggplot(sum_year_print, aes(x = Year, y=N_total)) + 
  geom_point(size = 4) + 
  labs(x = "Годы", y = "Количество \nединиц мусора \n(без учета пластиковых бутылок)") + 
  geom_smooth(se = F, method = "gam") +  
  scale_x_continuous(breaks=seq(min(sum_year_print$Year), max(sum_year_print$Year), 1))

Pl_botles <- 
  ggplot(sum_year_print, aes(x = Year, y=N_Botles)) + 
  geom_point(size = 4) + 
  labs(x = "Годы", y = "Количество \nпластиковых\n бутылок") + 
  geom_smooth(se = F, method = "gam") +
  scale_x_continuous(breaks=seq(min(sum_year_print$Year), max(sum_year_print$Year), 1))


plot_grid(Pl_Total, Pl_botles, ncol=1 )

```


\pagebreak

```{r, fig.cap=figRef("Space", "Распределение пластиковых бутылок на побережье о. Ряжкова в 2022-2023 гг. Patten of plastic botles distribution on the shore of Ryazhkov island шт 2022-2023"), fig.align="center"}

litter <- 
  litter %>% 
  filter(Year %in% c(2022, 2023))


ggmap(Ryazh_map, fullpage = F, darken=0, base_layer=ggplot(data=litter, aes(x=E, y=N, size = Plastic_botles))) +
  geom_point(shape=21, fill="yellow") + 
  facet_wrap(~Year, ncol = 4) + 
  labs(size = "Количество пластиковых бутылок \nна отдельных участках", x="", y ="") + 
  theme(axis.text = element_blank(), legend.position = "bottom", axis.ticks = element_blank())

# 
# ggplot(data = ggRyazhkov, aes(x=long, y=lat, group=group)) +  geom_polygon (fill = "gray70", colour = "black") + geom_point(data = litter, aes(x=E, y =N, size = Plastic_botles, group = 1), color = "black", position = position_jitter(width = 0.0001, height = 0.0001)) + labs(size = "Количество \nпластиковых \nбутылок \nна 100 м", x="", y ="") + facet_wrap(~ Year, ncol = 2)

```

