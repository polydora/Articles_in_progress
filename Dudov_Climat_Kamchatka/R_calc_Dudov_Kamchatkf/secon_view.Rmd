---
title: "Another_view"
output: html_document
date: ""
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## Data processing

```{r}
library(readxl)
library(dplyr)
library(ggplot2)

```


## Проблема № 1: что брать в качестве предиктора для описания климата

### Почему проблема

Климат описывается по многим параметрам большинство из них сильно коррелируют друг с другом. Если вставлять все эти параметры в одну модель, то коллинеарность между ними будет маскировать влияние друг относительно друга. Моедли построенные на такой матрице предиктоов будут иметь массу проблем (особенно если их использовать для пердсказаний).

### Как решать?

1. Возможно выбрать какой-то один параметр и считать его самым важным. Например, можно взять SWI и считать его единственным интересным параметром. Так можно, но, по-моему, неправильно терять информацию, например, по осадкам.

2. Поэтому предлагаю другой ход.

1.Делаем PCA по всем климатическим парамтрам за 2000-2003 гг (1999 не понимаю брать или не брать, так как в файле, вроде как с исходниками, RWI_BAI.xlsx, данные с 2000 года).

2. Выделяем PC, которые проходят по broken stick, как неслучайные.

3. Для каждой PC берем ту климатическйю метрику, которая имеет макисмальные нагрузки. Эти переменные и пойдут в дальнейший анализ в качестве предикторов.

Вот этот анализ

```{r}
clim <- read_excel("Data/bioclim.xlsx")

clim <-
  clim %>% 
  filter(as.numeric(Year) >= 2000)
  
library(vegan)

pca_clim <- rda(clim[,-1], scale = T)

```


Распределение собственных чисел 

```{r}
screeplot(pca_clim, bstick = T)
```


Можно говорить про четыре главные компоненты

```{r}
PC_scores <- as.data.frame(scores(pca_clim, choices = 1:4)$species)


```

По первой PC максимальную связь имеет: 

`r PC_scores %>% filter(abs(PC1) == max(abs(PC1))) ` 

По второй PC максимальную связь имеет: 

`r PC_scores %>% filter(abs(PC2) == max(abs(PC2))) ` 


По третьей PC максимальную связь имеет: 

`r PC_scores %>% filter(abs(PC3) == max(abs(PC3))) ` 

По четвертой PC максимальную связь имеет: 

`r PC_scores %>% filter(abs(PC4) == max(abs(PC4))) ` 


Итак, вот кандидаты на то, чтобы войти в число неколлинеарных пердикторов

+ BIO1 = Annual Mean Temperature
+ BIO13 = Precipitation of Wettest Month
+ BIO3 = Isothermality (BIO2/BIO7) (×100)
+ BIO5 = Max Temperature of Warmest Month

На всякий случай смотрим на корреляции между этими параметрами

```{r}
clim %>% 
  select(bio1, bio13, bio3, bio5) %>% 
  cor()
```

Есть высокая корреляция между BIO1 и BIO5, так что может из дальнейших построений BIO5 выкинем.


```{r}
library(mgcv)



```




