geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_hist + Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "blue", high = "red") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cyan", high = "red") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cyan", high = "black") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cyan", high = "red") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "blue70", high = "red") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "blue", high = "red") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1) +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
Pl_mod_gam
Pl_hist + Pl_mod_gam
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black") +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
scale_y_continuous(labels = percent_format())
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_freqpoly(binwidth = 0.1, color = "black", ) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", ) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", "Proportion")
Pl_hist
library(cowplot)
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "bottom") +
labs(x = "Structure score", y = "Proportion")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("blue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)+
geom_raster(aes(fill = Predict_gam))
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)+
geom_raster(aes(fill = Predict_gam), alpha = 0.5)
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
Pl_mod_gam
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
warnings()
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\n Т-morphotype") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
ntile(myt2$str, 10)
myt2 %>%  mutatr(str_class = ntile(str, 10))
myt2 %>%  mutate(str_class = ntile(str, 10))
myt2 %>%  mutate(str_class = ntile(str, 10)) %>% group_by(str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
myt2 %>%  mutate(str_class = ntile(str, 10)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 10)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str, fill = morph)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..))) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion") +
geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion") +
geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
Pl_hist
dense_rank(myt2$str)
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 10)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion") +
geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
Pl_hist
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 20)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion") +
geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 20)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion") +
geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
Pl_hist
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 5)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion") +
geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
Pl_hist
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\n Т-morphotype \npresence") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
```{r}
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 5)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
# +
#   geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
```
```{r}
library(cowplot)
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2)
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
mod_gam <- gam(ind ~ s(freq_MT, str, by = Subset) + Subset, data = myt2, family = "binomial")
myt2_WSBL <- myt2 %>% filter(Subset == "WSBL")
myt2_BH <- myt2 %>% filter(Subset == "BH")
myt2_BALT <- myt2 %>% filter(Subset == "BALT")
myt2_GOM <- myt2 %>% filter(Subset == "GOM")
new_data <-  myt2 %>% group_by(Subset) %>% do(expand.grid(str = seq(min(.$str), max(.$str), length.out = 20), freq_MT = seq(min(.$freq_MT), max(.$freq_MT), length.out = 20)))
new_data$Predict_gam <- predict(mod_gam, newdata = new_data, type = "response" )
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\nТ-morphotype \npresence") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
Pl_mod_gam
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 5)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
# +
#   geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
```
```{r}
library(cowplot)
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
```{r fig.width=10, fig.height=10}
library(cowplot)
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam^2)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\nТ-morphotype \npresence") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam^(1/2))) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\nТ-morphotype \npresence") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
Pl_mod_gam
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\nТ-morphotype \npresence") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
Pl_hist
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
prop_T <- myt2 %>%  mutate(str_class = ntile(str, 5)) %>% group_by(Subset, str_class) %>% summarise(str_mean = mean(str), Prop_T = mean(ind))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count../sum(..count..), fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme_bw() +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
# +
#   geom_point(data = prop_T, aes(x = str_mean, y = Prop_T))
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
myt2_WSBL <- myt2 %>% filter(Subset == "WSBL")
myt2_BH <- myt2 %>% filter(Subset == "BH")
myt2_BALT <- myt2 %>% filter(Subset == "BALT")
myt2_GOM <- myt2 %>% filter(Subset == "GOM")
new_data <-  myt2 %>% group_by(Subset) %>% do(expand.grid(str = seq(min(.$str), max(.$str), length.out = 20), freq_MT = seq(min(.$freq_MT), max(.$freq_MT), length.out = 20)))
new_data$Predict_gam <- predict(mod_gam, newdata = new_data, type = "response" )
Pl_mod_gam <-
ggplot(new_data, aes(x = freq_MT, y = str)) +
geom_raster(aes(fill = Predict_gam)) +
facet_wrap(~Subset, ncol = 1) +
scale_fill_gradient(low = "cornflowerblue", high = "red") +
theme_bw() +
labs(x = "Prevalence (proportion of M.trossulus)", y = "Structure score", fill = "Probability of\nТ-morphotype \npresence") +
geom_density_2d(data = myt2_WSBL, color = "white")+
geom_density_2d(data = myt2_BH, color = "white")+
geom_density_2d(data = myt2_BALT, color = "white")+
geom_density_2d(data = myt2_GOM, color = "white", n = 5) +
theme(panel.grid = element_blank())+
geom_point(data = myt2, aes(fill = ind), position = position_jitter(width = 0.01), shape = 21, size = 1)
plot_grid(Pl_hist, Pl_mod_gam, ncol = 2, labels = c("a", "b"))
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(y=..count.., fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme_bw() +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme_bw() +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Proportion")
Pl_hist
Pl_hist <-
ggplot(myt2, aes(x = str)) +
geom_histogram(binwidth = 0.1, color = "black", aes(fill = morph)) +
facet_wrap(~Subset, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c("cornflowerblue", "red" )) +
theme_bw() +
theme(panel.grid = element_blank()) +
guides(fill = "none") +
labs(x = "Structure score", y = "Count")
