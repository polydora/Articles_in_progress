"0","library(lme4)"
"0","library(ggplot2)"
"0","library(reshape2)"
"0","library(sjstats)"
"0","library(dplyr)"
"0","library(car)"
"0","library(doBy)"
"0","library(pROC)"
"0","library(betareg)"
"0","library(lmtest)"
"0","library(broom)"
"0","library(mgcv)"
"0","myt <- read.table(""data_salinity3.csv"", header = T, sep = "";"")"
"0","myt <- myt[myt$dataset != ""overseas"", ]"
"0","myt$Sp [myt$str > 0.5] <- ""M.trossulus"" #Лучше обозначать так!"
"0","myt$Sp [myt$str <= 0.5] <- ""M.edulis"""
"0","myt$Sp <- factor(myt$Sp)"
"0","# Оставляем только мидий, у которых есть оценка морфотипа"
"0","myt2 <- myt[!is.na(myt$ind), ]"
"0","# Вводим обозначения для морфотипов"
"0","myt2$morph <- ifelse(myt2$ind == 1, ""T_m"", ""E_m"")"
"0","myt2$morph <- factor(myt2$morph)"
"0","# Бинарное обозначение видов"
"0","myt2$Sp2 <- ifelse(myt2$Sp == ""M.trossulus"", 1, 0)"
"0","#Correct identification"
"0","myt2$congr <- ifelse((myt2$ind == 1 & myt2$Sp == ""M.trossulus"") | (myt2$ind == 0 & myt2$Sp == ""M.edulis""), 1, 0   )"
"0","# Частота M.trossulus в популяции, вычисленная как срденее значение structure"
"0","freq_MT <- summaryBy( str ~ pop, data = myt2)"
"0","names(freq_MT) <- c(""pop"", ""freq_MT"")"
"0","myt2 <- merge(myt2, freq_MT)"
"0","theme_set(theme_bw())"
"0","Pl_base <- ggplot(myt2, aes(x = freq_MT, y = str))  + facet_wrap(~facet) + scale_fill_gradient(low = ""yellow"", high = ""red"") + guides(fill = ""none"") + labs(x = ""Prevalence (proportion of M.trossulus)"", y = ""Structure"")"
"0","Pl_base + geom_point(aes(fill = ind), shape = 21)"
